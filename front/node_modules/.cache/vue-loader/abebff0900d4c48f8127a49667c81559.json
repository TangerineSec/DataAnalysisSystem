{"remainingRequest":"/Users/tangerine/Downloads/DataAnalysisSystem/front/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/tangerine/Downloads/DataAnalysisSystem/front/src/views/Page10/index.vue?vue&type=style&index=0&id=e61755aa&scoped=true&lang=css","dependencies":[{"path":"/Users/tangerine/Downloads/DataAnalysisSystem/front/src/views/Page10/index.vue","mtime":1758777469729},{"path":"/Users/tangerine/Downloads/DataAnalysisSystem/front/node_modules/css-loader/dist/cjs.js","mtime":1758780957262},{"path":"/Users/tangerine/Downloads/DataAnalysisSystem/front/node_modules/vue-loader-v16/dist/stylePostLoader.js","mtime":1758780958216},{"path":"/Users/tangerine/Downloads/DataAnalysisSystem/front/node_modules/postcss-loader/src/index.js","mtime":1758780957579},{"path":"/Users/tangerine/Downloads/DataAnalysisSystem/front/node_modules/cache-loader/dist/cjs.js","mtime":1758780956593},{"path":"/Users/tangerine/Downloads/DataAnalysisSystem/front/node_modules/vue-loader-v16/dist/index.js","mtime":1758780957586}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouY29udGFpbmVyIHsgLypwYWdlMV9iZy5wbmflm77niYfmlofku7bmlL7nva7lnKhWdWXpobnnm67nmoTpnZnmgIHotYTmupDnm67lvZXkuK3vvIzlvJXlhaXog4zmma8qLw0KICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoIn5AL2Fzc2V0cy9pbWcvcGFnZTEwL2JnLnBuZyIpOw0KICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0Ow0KICBiYWNrZ3JvdW5kLXNpemU6IGNvdmVyOw0KICBiYWNrZ3JvdW5kLWF0dGFjaG1lbnQ6IGZpeGVkOw0KfQ0KDQoNCi5oYW5kbGUtYm94IHsNCiAgbWFyZ2luLWJvdHRvbTogMjBweDsNCn0NCg0KLyoNCua1heeyieiJsu+8miNGRkI2QzENCua3oem7hOiJsu+8miNGRkZGRTANCuiWhOiNt+e7v++8miM5OEZCOTgNCua3oee0q+iJsu+8miNFNkU2RkENCuafoOaqrOiTne+8miMwMEZGRkYNCumykemxvOe6ou+8miNGQTgwNzINCuaymea7qeeZve+8miNGNUY1REMNCui/nuaet+iJsu+8miNGMEU2OEMNCueyieiTneiJsu+8miNFMUZGRkYNCuadj+S7gem7hO+8miNGRkVCQ0QNCiovDQoNCi5oYW5kbGUtc2VsZWN0IHsNCiAgd2lkdGg6IDEyMHB4Ow0KfQ0KDQouaGFuZGxlLWlucHV0IHsNCiAgd2lkdGg6IDMwMHB4Ow0KICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQp9DQoudGFibGUgew0KICB3aWR0aDogMTAwJTsNCiAgZm9udC1zaXplOiAxNHB4Ow0KICBoZWlnaHQ6IDY1MHB4Ow0KICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTsNCn0NCi5yZWQgew0KICBjb2xvcjogI2ZmMDAwMDsNCn0NCi5tcjEwIHsNCiAgbWFyZ2luLXJpZ2h0OiAxMHB4Ow0KfQ0KLnRhYmxlLXRkLXRodW1iIHsNCiAgZGlzcGxheTogYmxvY2s7DQogIG1hcmdpbjogYXV0bzsNCiAgd2lkdGg6IDQwcHg7DQogIGhlaWdodDogNDBweDsNCn0NCg=="},{"version":3,"sources":["/Users/tangerine/Downloads/DataAnalysisSystem/front/src/views/Page10/index.vue"],"names":[],"mappings":"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","file":"/Users/tangerine/Downloads/DataAnalysisSystem/front/src/views/Page10/index.vue","sourceRoot":"","sourcesContent":["<template>\r\n  <div>\r\n\r\n    <div class=\"crumbs\">\r\n    </div>\r\n    <div class=\"container\">\r\n\r\n\r\n      <div class=\"handle-box\">\r\n\r\n        <a href=\"https://musetransfer.com/s/1lktfah6c\" target=\"_black\"><el-button type=\"danger\" icon=\"el-icon-upload\" >点击模版下载:密码6156</el-button></a>\r\n        <el-button type=\"success\" icon=\"el-icon-upload\" @click=\"handleAdd\" style=\"margin: 0px 0px 0px 10px\">选择Excel</el-button>\r\n        <el-select placeholder=\"Sheet_name1\" v-model=\"selectedSheet1\" style=\"margin: 0px 0px 0px 10px\">\r\n          <el-option  v-for=\"(d, index) in sheet1\" :label=d :value=d></el-option>\r\n        </el-select>\r\n        <el-select placeholder=\"主题\" v-model=\"selectedTheme\" style=\"margin: 0px 0px 0px 10px\">\r\n          <el-option  v-for=\"(d, index) in theme\" :label=d :value=d></el-option>\r\n        </el-select>\r\n        <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"handlePreview\" style=\"margin: 0px 0px 0px 10px\">先预览数据</el-button>\r\n        <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"handlePreviewCharts\" style=\"margin: 0px 0px 0px 10px\">再预览图片</el-button>\r\n\r\n\r\n      </div>\r\n      输入文件注意事项：该模板文件要求格式为xlsx表格，数据列：真实姓名和学号不能为空，其余列数据必须为有效数字数据，不能为符号”-“，若无有效成绩请替换为0。\r\n      <div style=\"margin: 50px auto; width: 200px\"  v-show=\"showTableHeader2.length !== 0\">表格</div>\r\n      <el-table empty-text=\"导入数据后显示\" :data=\"showTableData1\" border class=\"table\" ref=\"multipleTable\" header-cell-class-name=\"table-header\" :fit=\"true\">\r\n        <el-table-column v-for=\"(d, index) in showTableHeader1\" :prop=\"d.code\" :label=\"d.name\"  align=\"center\"></el-table-column>\r\n      </el-table>\r\n\r\n      <div>\r\n        <img style=\"width: 100%\" src=\"https://githubwiki.oss-cn-shanghai.aliyuncs.com/img/typroa/2023-10-25_22-54-42.jpg\">\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <!-- 编辑弹出框 -->\r\n    <el-dialog title=\"点击方框或拖拽文件，可导入文件\" v-model=\"diaLogShow\"   width=\"30%\">\r\n      <el-form    >\r\n\r\n        <el-form-item label=\"选择文件\" prop=\"file\">\r\n          <el-upload\r\n              class=\"upload-import\"\r\n              ref=\"upload1\"\r\n              action=\"\"\r\n              :limit=\"1\"\r\n              :drag=\"true\"\r\n              :auto-upload=\"false\">\r\n          </el-upload>\r\n        </el-form-item>\r\n\r\n\r\n      </el-form>\r\n      <template #footer>\r\n                <span class=\"dialog-footer\">\r\n                    <el-button @click=\"diaLogShow = false\">取 消</el-button>\r\n                    <el-button type=\"primary\" @click=\"submit\">确 定</el-button>\r\n                </span>\r\n      </template>\r\n    </el-dialog>\r\n    <el-dialog v-model=\"showIframe\"  width=\"90%\" >\r\n      <iframe :src=\"iframeUrl\" frameborder=\"0\" style=\"width: 100%; height: 700px\">\r\n\r\n      </iframe>\r\n    </el-dialog>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\n\r\nexport default {\r\n  name: \"table\",\r\n  data() {\r\n  // 使用 data 对象可以很方便地管理组件中所需的数据，并且能够保证组件的响应性能力\r\n    return {\r\n      showIframe: false,\r\n      iframeUrl: '',\r\n      diaLogShow: false,\r\n      filename1: '',\r\n      filename2: '',\r\n      filename3: '',\r\n\r\n      sheet1: [],\r\n      sheet2: [],\r\n      sheet3: [],\r\n      selectedTheme: 'westeros',\r\n      theme: [\r\n        \"light\",\r\n        \"dark\",\r\n        \"white\",\r\n        \"chalk\",\r\n        \"essos\",\r\n        \"infographic\",\r\n        \"macarons\",\r\n        \"purple-passion\",\r\n        \"roma\",\r\n        \"romantic\",\r\n        \"shine\",\r\n        \"vintage\",\r\n        \"walden\",\r\n        \"westeros\",\r\n        \"wonderland\",\r\n        \"halloween\",\r\n      ],\r\n      selectedSheet1: '',\r\n\r\n\r\n      showTableData1: [],\r\n      showTableHeader1: [\r\n          { code: \"date\", name: \"真实姓名\" },\r\n          { code: \"date\", name: \"学号\" },\r\n          { code: \"date\", name:\"分组名称\" },\r\n          { code: \"date\", name: \"spoc成绩\" },\r\n          { code: \"date\",  name: \"视频观看个数\" },\r\n          { code: \"date\", name: \"视频观看次数\" },\r\n          { code: \"date\", name: \"视频观看时长\" },\r\n          { code: \"date\", name: \"讨论区评论数+回复数\" },\r\n      ],\r\n      showTableData2: [],\r\n      showTableHeader2: ['暂无数据'],\r\n      showTableData3: [],\r\n      showTableHeader3: ['暂无数据'],\r\n      exportFileName: '',\r\n    }\r\n  },\r\n  methods: {\r\n    handlePreviewCharts() {\r\n      //点击绑定的查看图片，这段代码的功能是在新窗口中打开一个URL\r\n      const baseUrl = process.env.VUE_APP_BASE_URL\r\n      const url = baseUrl + '/export_view10?filename1=' + this.filename1 + '&sheet1=' + this.selectedSheet1 + '&theme=' + this.selectedTheme\r\n\r\n      axios.get(url).then(response => {\r\n        this.showTableHeader1 =  response.data.data.headers\r\n        this.showTableData1 =  response.data.data.data\r\n        this.showTableHeader2 = []\r\n        this.showTableData2 = []\r\n        this.filename =  ''\r\n        this.exportFileName =  response.data.data.filename\r\n      })\r\n      // 这个export_zip函数是专门用来读取下载文件的，一个事件可以触发多个动作：首先渲染触发动作，然后就是下载该文件。\r\n      const url1 = baseUrl + '/export_zip?filename=' + \"SPOC雷达图.zip\"\r\n      window.open(url1)\r\n    },\r\n    handlePreview() {\r\n      //点击绑定的handlePreview，导入Excel可以查看数据\r\n      if (this.sheet1 == '' ) {\r\n        alert('请先选择sheet')\r\n        return\r\n      }\r\n      const baseUrl = process.env.VUE_APP_BASE_URL\r\n      const url = baseUrl + '/get_one_excel_data?filename1='\r\n          + this.filename1 + '&sheet1=' + this.selectedSheet1\r\n      console.log('url:', url)\r\n\r\n      this.showTableData1 =  []\r\n      this.showTableHeader1=[]\r\n      axios.get(url,).then(response => {\r\n        // 三个数组来分别存储三个表格的表头数据，使用方法：this.showTableHeader1 = response.data.data.headers;\r\n        console.log(response.data.data.data1.data)\r\n        this.showTableData1 =  response.data.data.data1.data.slice(1)\r\n        this.showTableHeader1 =  response.data.data.data1.headers.slice(0)\r\n          }\r\n      )\r\n    },\r\n    submit() {\r\n      //点击提交之后的函数处理\r\n      const baseUrl = process.env.VUE_APP_BASE_URL\r\n      const url = baseUrl + '/upload_file_and_get_sheet_name'\r\n      let formData = new FormData();\r\n      const files1 = this.$refs.upload1.uploadFiles\r\n      if (files1.length === 0 ) {\r\n        alert('文件为空')\r\n        return\r\n      }\r\n      let file1 = files1[0].raw\r\n      formData.append('file1', file1)\r\n      console.log(url);\r\n      // 添加请求头\r\n      axios.post(url,formData,{\r\n        'Content-type' : 'multipart/form-data'\r\n      })\r\n          .then(response => {\r\n            console.log(response.data)\r\n            if (response.data.code === 200) {\r\n              // this.showTableHeader1 =  response.data.data.data1.headers\r\n              // this.showTableData1 =  response.data.data.data1.data\r\n              this.filename1 =  response.data.data.data1.filename\r\n              this.sheet1 = response.data.data.data1.sheet\r\n\r\n              this.exportFileName = ''\r\n              this.$refs.upload1.uploadFiles = []\r\n              this.diaLogShow = false\r\n\r\n            } else {\r\n              alert(response.data.msg)\r\n            }\r\n          })\r\n\r\n    },\r\n\r\n    handleAdd() {\r\n      //点击选择Excel\r\n      this.form = {}\r\n      this.diaLogShow = true\r\n      this.$refs.upload1.uploadFiles = []\r\n    },\r\n  },\r\n  mounted() {\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.container { /*page1_bg.png图片文件放置在Vue项目的静态资源目录中，引入背景*/\r\n  background-image: url(\"~@/assets/img/page10/bg.png\");\r\n  background-repeat: no-repeat;\r\n  background-size: cover;\r\n  background-attachment: fixed;\r\n}\r\n\r\n\r\n.handle-box {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n/*\r\n浅粉色：#FFB6C1\r\n淡黄色：#FFFFE0\r\n薄荷绿：#98FB98\r\n淡紫色：#E6E6FA\r\n柠檬蓝：#00FFFF\r\n鲑鱼红：#FA8072\r\n沙滩白：#F5F5DC\r\n连枷色：#F0E68C\r\n粉蓝色：#E1FFFF\r\n杏仁黄：#FFEBCD\r\n*/\r\n\r\n.handle-select {\r\n  width: 120px;\r\n}\r\n\r\n.handle-input {\r\n  width: 300px;\r\n  display: inline-block;\r\n}\r\n.table {\r\n  width: 100%;\r\n  font-size: 14px;\r\n  height: 650px;\r\n  background-color: white;\r\n}\r\n.red {\r\n  color: #ff0000;\r\n}\r\n.mr10 {\r\n  margin-right: 10px;\r\n}\r\n.table-td-thumb {\r\n  display: block;\r\n  margin: auto;\r\n  width: 40px;\r\n  height: 40px;\r\n}\r\n</style>\r\n"]}]}